---
author: "Elizabeth Borgognoni Souto"
date: "5/4/2020"
output: 
  html_document:
    theme: cerulean
    highlight: tango
    toc_float:
      collapsed: true
      smooth_scroll: true
---

```{r, echo = FALSE, message=FALSE, warning=FALSE}
# carregando pacotes para manipulação das planilhas
library("tidyverse")
library("janitor")
library("readxl")
library("DT")
options(DT.options = list(pageLength = 5))
```


### Leitura das planilhas e limpeza dos dados:

Na parte de limpeza dos dados, foram removidas todas as colunas vazias ou que continham números sem sentido, as planilhas estão separadas pois diferem em muitos aspectos. Os valores: 0 ou 1, true ou false, foram mudados para sim ou não.

#### Planilha de dados das faxinas do Pureco de 2018 a 2019
```{r, echo = FALSE, message=FALSE, warning=FALSE}

## ainda falta mudar formato de data na mesma ordem da brasileira
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE)

faxinas201819 <- faxinas201819 %>% 
  mutate(Data = as.numeric(Data), `Ocorreu?` = as.logical(`Ocorreu?`)) %>%
  mutate(Data = excel_numeric_to_date(Data)) %>% 
  mutate_at(c("Cliente", "Endereço"), funs(ifelse(. == "-", NA, .))) %>%
  select(c(1:11)) %>% rename(Comentarios = "...11") %>% 
  remove_empty("rows") 

faxinas201819 <- faxinas201819 %>%
  mutate(`Ocorreu?` = as.character(`Ocorreu?`), `Feedback Colhido?` = as.character(`Feedback Colhido?`))

 faxinas201819[faxinas201819 == TRUE] <- "Sim"
 faxinas201819[faxinas201819 == FALSE] <- "Não"

```

```{r, echo = FALSE}
# depois customizar a tabela com os tamanhos certos "custom table container"
# posso usar essa opcao de edicao para mudar coisas mais rápidas talvez
# adicionar show number of pags
datatable(faxinas201819, colnames = c('ID' = 1), 
          caption = 'Tabela 1: Gerenciamento do Aplicativo entre o período de 2018 a 2019.', 
          editable = 'cell',
          plugins = 'natural', extensions = c('Buttons'), 
          style = 'bootstrap', class = 'table-bordered table-condensed',
          options = list(
            dom = 'Bfrtip',
            buttons = c('csv', 'excel', 'pdf', 'print','colvis')))

```

#### Planilha de dados das faxinas do Pureco de 2019 a 2020
```{r, echo = FALSE, message=FALSE, warning=FALSE}

## ainda falta mudar formato de data na mesma ordem da brasileira

faxinas201920 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2019-2020]GerenciamentodoAplicativo.xlsx", sheet = 2, skip = 1, col_names = TRUE)

faxinas201920  <- faxinas201920[,-1]

faxinas201920$Data <- as.POSIXct(faxinas201920$Data, format="%d/%m/%Y")


```

```{r, echo = FALSE}
# depois customizar a tabela com os tamanhos certos "custom table container"
datatable(faxinas201920, colnames = c('ID' = 1),
          caption = 'Tabela 2: Gerenciamento do Aplicativo entre o período de 2019 a 2020.',
          class = 'cell-border stripe', 
          plugins = 'natural', extensions = c('Buttons'), 
          options = list(
            dom = 'Bfrtip',
            buttons = c('csv', 'excel', 'pdf', 'print','colvis')))
```


#### Ideias para melhorar as planilhas: 

- | Nas colunas: **Feedback cliente** e **Feedback mulher** evitar colocar os dados como : **2,5 ~ 3,0** pois não é possível trabalhar com a análise nesse formato de nota, nesse caso, por exemplo, poderíam fazer uma média entre esses valores.

- | Nas duas planilhas há valores com apenas o número e valores com R$ na frente do número, seria melhor escolher apenas um para representar na tabela. 

- | Na última coluna da planilha mais antiga, observa-se apenas as colunas **Ocorreu?** e **Feedback Colhido?** preenchidas, nesse caso não sei se esses dados são verídicos ou se alguém esqueceu de preencher as informações das outras  colunas.

- | A variável **Onde foi colhido?** tem poucos dados preenchidos.

#### Ideias de análises e gráficos:

- | Mapas, acrescentar latitude e longitude de acordo com os endereços
- | Gráfico que mostre a porcentagem de faxinas que não ocorreram e que foram remarcadas ou nao
- | Analise de comentarios positivos 
- | Gráfico do valor ganho com as faxinas por mês para cada faxineira 
