# modificar Av. , Av para Avenida
faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
#nao consegui fazer encontrar um caractere antes de qualquer frase que nao começe com Rua, e nao seja Av. trocar manualmente
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço , "(^(^Rua$)*)", "Rua ")
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço, "^(Rua Av.*)", "Av.*")
# faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "(Rua| )*", "Rua ")
# faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
# str_view(testepalavra, "(^(^Rua\\$))*")
# str_view(testepalavra, "^[^A-Za-z]*[^\\Rua]")
# str_view(testepalavra3, "(Rua|Av)")
# depois customizar a tabela com os tamanhos certos "custom table container"
# posso usar essa opcao de edicao para mudar coisas mais rápidas talvez
# adicionar show number of pags
datatable(
faxinas201819,
colnames = c('ID' = 1),
caption = htmltools::tags$caption(
style = 'caption-side: top; text-align: left; color:blue; font-size: 16px',
'Tabela 1: ',
htmltools::em('Gerenciamento do Aplicativo entre o período de 2018 a 2019.',)
),
editable = 'cell',
extensions = c('Buttons'),
class = c('cell-border stripe'),
options = list(
dom = 'Bfrtip',
buttons = c('csv', 'excel', 'pdf', 'print', 'colvis')
)
)
faxinas201920 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2019-2020]GerenciamentodoAplicativo.xlsx", skip = 1, sheet = 2, col_names = TRUE, col_types = c("guess", "logical", "logical", "text", "numeric", "text", "text", "text", "text", "logical", "text", "numeric", "numeric", "text", "text"), range = "B2:P253")
faxinas201920 <- faxinas201920 %>%
mutate(`Feedback Colhido?` = as.character(`Feedback Colhido?`),
Remarcou = as.character(Remarcou), `Ocorreu?` = as.character(`Ocorreu?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(`Onde foi colhido?`= `Onde foi colhido`)
# faxinas201920$Valor <- formatC(faxinas201920$Valor, format = "f", digits = 2, decimal.mark = ",")
faxinas201920$Data <- format(faxinas201920$Data, "%d/%m/%Y")
faxinas201920[faxinas201920 == "TRUE"] <- "Sim"
faxinas201920[faxinas201920 == "FALSE"] <- "Não"
# mudar ocorreu pra sim e nao usando regex
faxinas201920$Cliente <- str_trim(str_to_title(faxinas201920$Cliente))
faxinas201920$Endereço <- str_trim(str_to_title(faxinas201920$Endereço))
faxinas201920$Comentários <- str_trim(faxinas201920$Comentários)
faxinas201920$Endereço <-  str_replace_all(faxinas201920$Endereço, "R\\.", "Rua ")
faxinas201920$Endereço <- str_replace_all(faxinas201920$Endereço, "R ", "Rua ")
faxinas201920$Endereço <- str_trim(str_to_title(faxinas201920$Endereço))
# depois customizar a tabela com os tamanhos certos "custom table container"
datatable(
faxinas201920,
colnames = c('ID' = 1),
caption =  htmltools::tags$caption(
style = 'caption-side: top; text-align: left; color:blue; font-size: 16px',
'Tabela 2: ',
htmltools::em('Gerenciamento do Aplicativo entre o período de 2019 a 2020.',)
),
class = c('cell-border stripe'),
extensions = c('Buttons'),
options = list(
dom = 'Bfrtip',
buttons = c('csv', 'excel', 'pdf', 'print', 'colvis')
)
)
faxinas201819$`Feedback cliente` <- as.double(faxinas201819$`Feedback cliente`)
faxinas201819 <- faxinas201819 %>%
rename(`Nota feedback cliente` = `Feedback cliente`, `Nota feedback mulher` = `Feedback mulher`)
# perguntar se junta feedback cliente da planilha nova com comentarios
# faxinas201920 <- faxinas201920 %>%
#   unite(`Comentários`, c(`Feedback cliente`,`Comentários`), na.rm = TRUE, remove = FALSE)
#
# faxinas201920$Comentários[faxinas201920$Comentários == '""'] <- "NA"
# faxinas201920[,"Comentários" == ""] <- "NA"
faxinas <- full_join(faxinas201920, faxinas201819,
by = c("Data", "Mulher", "Valor", "Cliente", "Endereço", "Ocorreu?", "Feedback Colhido?",
"Onde foi colhido?", "Nota feedback mulher", "Nota feedback cliente", "Comentários"))
faxinas <- faxinas %>% distinct()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
setwd("~/Documents/PURECO-BAS/Pureco")
runApp()
library('shiny')
library('flexdashboard')
library('rmarkdown')
knit_with_parameters('~/Documents/PURECO-BAS/Pureco/www/Relatoriodados.Rmd')
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
library(tidyverse)
library(sf)
library(mapview)
library(lubridate)
library(forecast)
library(tseries)
library(curl)
library(plotly)
library(leaflet)
library(geosphere)
library(shiny)
library(shinythemes)
library(DT)
library(tsibble)
library(zoo)
library(xts)
library(rsconnect)
library(dygraphs)
library('htmltools')
library('html')
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
library("shiny")
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
knitr::opts_chunk$set(echo = FALSE)
# carregando pacotes para manipulação das planilhas
library("stringr")
library("tidyverse")
library("janitor")
library("readxl")
library("DT")
library("rebus")
library("flexdashboard")
options(DT.options = list(
columnDefs = list(list(className = 'dt-center', targets = 5)),
pageLength = 5,
lengthMenu = c(5, 10, 15, 20)))
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "numeric", "numeric", "text"), range = "A2:K432")
# as.POSIXct(faxinas$Data, "UTC", format="%d/%m/%Y")
faxinas201819 <- faxinas201819 %>%
mutate(`Ocorreu?` = as.character(`Ocorreu?`),
`Feedback Colhido?` = as.character(`Feedback Colhido?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(Comentários = "...11")
# perguntar se posso excluir
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "NA"
faxinas201819[faxinas201819 == TRUE] <- "Sim"
faxinas201819[faxinas201819 == FALSE] <- "Não"
faxinas201819$Data <- format(faxinas201819$Data, "%d/%m/%Y")
# faxinas201819$Valor <- formatC(faxinas201819$Valor, format = "f", digits = 2, decimal.mark = ",")
faxinas201819$Cliente <- str_trim(str_to_title(faxinas201819$Cliente))
faxinas201819$Comentários <- str_trim(faxinas201819$Comentários)
faxinas201819$Endereço <-  str_replace_all(faxinas201819$Endereço, "R\\.", "Rua ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "R ", "Rua ")
# modificar Av. , Av para Avenida
faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
#nao consegui fazer encontrar um caractere antes de qualquer frase que nao começe com Rua, e nao seja Av. trocar manualmente
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço , "(^(^Rua$)*)", "Rua ")
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço, "^(Rua Av.*)", "Av.*")
# faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "(Rua| )*", "Rua ")
# faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
# str_view(testepalavra, "(^(^Rua\\$))*")
# str_view(testepalavra, "^[^A-Za-z]*[^\\Rua]")
# str_view(testepalavra3, "(Rua|Av)")
# depois customizar a tabela com os tamanhos certos "custom table container"
# posso usar essa opcao de edicao para mudar coisas mais rápidas talvez
# adicionar show number of pags
datatable(
faxinas201819,
colnames = c('ID' = 1),
caption = htmltools::tags$caption(
style = 'caption-side: top; text-align: left; color:blue; font-size: 16px',
'Tabela 1: ',
htmltools::em('Gerenciamento do Aplicativo entre o período de 2018 a 2019.',)
),
editable = 'cell',
extensions = c('Buttons'),
class = c('cell-border stripe'),
options = list(
dom = 'Bfrtip',
buttons = c('csv', 'excel', 'pdf', 'print', 'colvis')
)
)
faxinas201920 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2019-2020]GerenciamentodoAplicativo.xlsx", skip = 1, sheet = 2, col_names = TRUE, col_types = c("guess", "logical", "logical", "text", "numeric", "text", "text", "text", "text", "logical", "text", "numeric", "numeric", "text", "text"), range = "B2:P253")
faxinas201920 <- faxinas201920 %>%
mutate(`Feedback Colhido?` = as.character(`Feedback Colhido?`),
Remarcou = as.character(Remarcou), `Ocorreu?` = as.character(`Ocorreu?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(`Onde foi colhido?`= `Onde foi colhido`)
# faxinas201920$Valor <- formatC(faxinas201920$Valor, format = "f", digits = 2, decimal.mark = ",")
faxinas201920$Data <- format(faxinas201920$Data, "%d/%m/%Y")
faxinas201920[faxinas201920 == "TRUE"] <- "Sim"
faxinas201920[faxinas201920 == "FALSE"] <- "Não"
# mudar ocorreu pra sim e nao usando regex
faxinas201920$Cliente <- str_trim(str_to_title(faxinas201920$Cliente))
faxinas201920$Endereço <- str_trim(str_to_title(faxinas201920$Endereço))
faxinas201920$Comentários <- str_trim(faxinas201920$Comentários)
faxinas201920$Endereço <-  str_replace_all(faxinas201920$Endereço, "R\\.", "Rua ")
faxinas201920$Endereço <- str_replace_all(faxinas201920$Endereço, "R ", "Rua ")
faxinas201920$Endereço <- str_trim(str_to_title(faxinas201920$Endereço))
# depois customizar a tabela com os tamanhos certos "custom table container"
datatable(
faxinas201920,
colnames = c('ID' = 1),
caption =  htmltools::tags$caption(
style = 'caption-side: top; text-align: left; color:blue; font-size: 16px',
'Tabela 2: ',
htmltools::em('Gerenciamento do Aplicativo entre o período de 2019 a 2020.',)
),
class = c('cell-border stripe'),
extensions = c('Buttons'),
options = list(
dom = 'Bfrtip',
buttons = c('csv', 'excel', 'pdf', 'print', 'colvis')
)
)
faxinas201819$`Feedback cliente` <- as.double(faxinas201819$`Feedback cliente`)
faxinas201819 <- faxinas201819 %>%
rename(`Nota feedback cliente` = `Feedback cliente`, `Nota feedback mulher` = `Feedback mulher`)
# perguntar se junta feedback cliente da planilha nova com comentarios
# faxinas201920 <- faxinas201920 %>%
#   unite(`Comentários`, c(`Feedback cliente`,`Comentários`), na.rm = TRUE, remove = FALSE)
#
# faxinas201920$Comentários[faxinas201920$Comentários == '""'] <- "NA"
# faxinas201920[,"Comentários" == ""] <- "NA"
faxinas <- full_join(faxinas201819, faxinas201920,
by = c("Data", "Mulher", "Valor", "Cliente", "Endereço", "Ocorreu?", "Feedback Colhido?",
"Onde foi colhido?", "Nota feedback mulher", "Nota feedback cliente", "Comentários"))
faxinas <- faxinas %>% distinct() %>% group_by(Data)
write_csv(faxinas, "/home/elizemiku/Documents/PURECO-BAS/Pureco/dados/faxinas.csv")
warning()
warnings()
warnings()
?full_join
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
str_view(faxinas201819$Endereço, "Av", "Avenida ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "Av ", "Avenida ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "Av.", "Avenida ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "^Av.", "Avenida ")
knitr::opts_chunk$set(echo = FALSE)
# carregando pacotes para manipulação das planilhas
library("stringr")
library("tidyverse")
library("janitor")
library("readxl")
library("DT")
library("rebus")
library("flexdashboard")
options(DT.options = list(
columnDefs = list(list(className = 'dt-center', targets = 5)),
pageLength = 5,
lengthMenu = c(5, 10, 15, 20)))
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "numeric", "numeric", "text"), range = "A2:K432")
# as.POSIXct(faxinas$Data, "UTC", format="%d/%m/%Y")
faxinas201819 <- faxinas201819 %>%
mutate(`Ocorreu?` = as.character(`Ocorreu?`),
`Feedback Colhido?` = as.character(`Feedback Colhido?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(Comentários = "...11")
# perguntar se posso excluir
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "NA"
faxinas201819[faxinas201819 == TRUE] <- "Sim"
faxinas201819[faxinas201819 == FALSE] <- "Não"
faxinas201819$Data <- format(faxinas201819$Data, "%d/%m/%Y")
# faxinas201819$Valor <- formatC(faxinas201819$Valor, format = "f", digits = 2, decimal.mark = ",")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "^Av.", "Avenida ")
knitr::opts_chunk$set(echo = FALSE)
# carregando pacotes para manipulação das planilhas
library("stringr")
library("tidyverse")
library("janitor")
library("readxl")
library("DT")
library("rebus")
library("flexdashboard")
options(DT.options = list(
columnDefs = list(list(className = 'dt-center', targets = 5)),
pageLength = 5,
lengthMenu = c(5, 10, 15, 20)))
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "numeric", "numeric", "text"), range = "A2:K432")
# as.POSIXct(faxinas$Data, "UTC", format="%d/%m/%Y")
faxinas201819 <- faxinas201819 %>%
mutate(`Ocorreu?` = as.character(`Ocorreu?`),
`Feedback Colhido?` = as.character(`Feedback Colhido?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(Comentários = "...11")
# perguntar se posso excluir
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "NA"
faxinas201819[faxinas201819 == TRUE] <- "Sim"
faxinas201819[faxinas201819 == FALSE] <- "Não"
faxinas201819$Data <- format(faxinas201819$Data, "%d/%m/%Y")
# faxinas201819$Valor <- formatC(faxinas201819$Valor, format = "f", digits = 2, decimal.mark = ",")
runApp()
faxinas201819
faxinas201819$`Feedback cliente`
faxinas201819$`Feedback cliente`
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "3,0"
faxinas201819$`Feedback cliente`
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"]
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "guess", "numeric", "text"), range = "A2:K432")
# carregando pacotes para manipulação das planilhas
library("stringr")
library("tidyverse")
library("janitor")
library("readxl")
library("DT")
library("rebus")
library("flexdashboard")
options(DT.options = list(
columnDefs = list(list(className = 'dt-center', targets = 5)),
pageLength = 5,
lengthMenu = c(5, 10, 15, 20)))
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "guess", "numeric", "text"), range = "A2:K432")
faxinas201819
faxinas201819$`Feedback cliente`
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "3,0"
faxinas201819$`Feedback cliente`
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "3.0"
faxinas201819$`Feedback cliente`
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "guess", "numeric", "text"), range = "A2:K432")
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "3.0"
faxinas201819$`Feedback cliente`
as.numeric(faxinas201819$`Feedback cliente`)
# perguntar se posso excluir
faxinas201819$`Feedback cliente` <- as.numeric(faxinas201819$`Feedback cliente`)
faxinas201819[faxinas201819 == TRUE] <- "Sim"
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "guess", "numeric", "text"), range = "A2:K432")
# as.POSIXct(faxinas$Data, "UTC", format="%d/%m/%Y")
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "3.0"
faxinas201819 <- faxinas201819 %>%
mutate(`Ocorreu?` = as.character(`Ocorreu?`),
`Feedback Colhido?` = as.character(`Feedback Colhido?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(Comentários = "...11")
# perguntar se posso excluir
faxinas201819$`Feedback cliente` <- as.numeric(faxinas201819$`Feedback cliente`)
faxinas201819[faxinas201819 == TRUE] <- "Sim"
# perguntar se posso excluir
faxinas201819[faxinas201819 == TRUE] <- "Sim"
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "guess", "numeric", "text"), range = "A2:K432")
# as.POSIXct(faxinas$Data, "UTC", format="%d/%m/%Y")
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "3.0"
faxinas201819 <- faxinas201819 %>%
mutate(`Ocorreu?` = as.character(`Ocorreu?`),
`Feedback Colhido?` = as.character(`Feedback Colhido?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(Comentários = "...11")
# perguntar se posso excluir
faxinas201819[faxinas201819 == TRUE] <- "Sim"
faxinas201819[faxinas201819 == FALSE] <- "Não"
faxinas201819$Data <- format(faxinas201819$Data, "%d/%m/%Y")
faxinas201819$`Feedback cliente` <- as.numeric(faxinas201819$`Feedback cliente`)
# faxinas201819$Valor <- formatC(faxinas201819$Valor, format = "f", digits = 2, decimal.mark = ",")
faxinas201819$Cliente <- str_trim(str_to_title(faxinas201819$Cliente))
faxinas201819$Comentários <- str_trim(faxinas201819$Comentários)
faxinas201819$Endereço <-  str_replace_all(faxinas201819$Endereço, "R\\.", "Rua ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "R ", "Rua ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "^Av.", "Avenida ")
# modificar Av. , Av para Avenida
faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
#nao consegui fazer encontrar um caractere antes de qualquer frase que nao começe com Rua, e nao seja Av. trocar manualmente
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço , "(^(^Rua$)*)", "Rua ")
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço, "^(Rua Av.*)", "Av.*")
# faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "(Rua| )*", "Rua ")
# faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
# str_view(testepalavra, "(^(^Rua\\$))*")
# str_view(testepalavra, "^[^A-Za-z]*[^\\Rua]")
# str_view(testepalavra3, "(Rua|Av)")
knitr::opts_chunk$set(echo = FALSE)
# carregando pacotes para manipulação das planilhas
library("stringr")
library("tidyverse")
library("janitor")
library("readxl")
library("DT")
library("rebus")
library("flexdashboard")
options(DT.options = list(
columnDefs = list(list(className = 'dt-center', targets = 5)),
pageLength = 5,
lengthMenu = c(5, 10, 15, 20)))
faxinas201819 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2018-2019]GerenciamentodoAplicativo.xlsx", skip = 1, col_names = TRUE, col_types = c("guess", "text", "numeric", "text", "text", "logical", "logical", "text", "guess", "numeric", "text"), range = "A2:K432")
# as.POSIXct(faxinas$Data, "UTC", format="%d/%m/%Y")
faxinas201819$`Feedback cliente`[faxinas201819$`Feedback cliente` == "2,5 ~ 3,0"] <- "3.0"
faxinas201819 <- faxinas201819 %>%
mutate(`Ocorreu?` = as.character(`Ocorreu?`),
`Feedback Colhido?` = as.character(`Feedback Colhido?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(Comentários = "...11")
# perguntar se posso excluir
faxinas201819[faxinas201819 == TRUE] <- "Sim"
faxinas201819[faxinas201819 == FALSE] <- "Não"
faxinas201819$Data <- format(faxinas201819$Data, "%d/%m/%Y")
faxinas201819$`Feedback cliente` <- as.numeric(faxinas201819$`Feedback cliente`)
# faxinas201819$Valor <- formatC(faxinas201819$Valor, format = "f", digits = 2, decimal.mark = ",")
faxinas201819$Cliente <- str_trim(str_to_title(faxinas201819$Cliente))
faxinas201819$Comentários <- str_trim(faxinas201819$Comentários)
faxinas201819$Endereço <-  str_replace_all(faxinas201819$Endereço, "R\\.", "Rua ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "R ", "Rua ")
faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "^Av.", "Avenida ")
# modificar Av. , Av para Avenida
faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
#nao consegui fazer encontrar um caractere antes de qualquer frase que nao começe com Rua, e nao seja Av. trocar manualmente
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço , "(^(^Rua$)*)", "Rua ")
# faxinas201819$Endereço <- str_replace(faxinas201819$Endereço, "^(Rua Av.*)", "Av.*")
# faxinas201819$Endereço <- str_replace_all(faxinas201819$Endereço, "(Rua| )*", "Rua ")
# faxinas201819$Endereço <- str_trim(str_to_title(faxinas201819$Endereço))
# str_view(testepalavra, "(^(^Rua\\$))*")
# str_view(testepalavra, "^[^A-Za-z]*[^\\Rua]")
# str_view(testepalavra3, "(Rua|Av)")
# depois customizar a tabela com os tamanhos certos "custom table container"
# posso usar essa opcao de edicao para mudar coisas mais rápidas talvez
# adicionar show number of pags
datatable(
faxinas201819,
colnames = c('ID' = 1),
caption = htmltools::tags$caption(
style = 'caption-side: top; text-align: left; color:blue; font-size: 16px',
'Tabela 1: ',
htmltools::em('Gerenciamento do Aplicativo entre o período de 2018 a 2019.',)
),
editable = 'cell',
extensions = c('Buttons'),
class = c('cell-border stripe'),
options = list(
dom = 'Bfrtip',
buttons = c('csv', 'excel', 'pdf', 'print', 'colvis')
)
)
faxinas201920 <- read_xlsx("/home/elizemiku/Documents/PURECO-BAS/[2019-2020]GerenciamentodoAplicativo.xlsx", skip = 1, sheet = 2, col_names = TRUE, col_types = c("guess", "logical", "logical", "text", "numeric", "text", "text", "text", "text", "logical", "text", "numeric", "numeric", "text", "text"), range = "B2:P253")
faxinas201920 <- faxinas201920 %>%
mutate(`Feedback Colhido?` = as.character(`Feedback Colhido?`),
Remarcou = as.character(Remarcou), `Ocorreu?` = as.character(`Ocorreu?`)) %>%
mutate_at(c("Cliente", "Endereço"),
funs(ifelse(. == "-" |. == "--" | . == "/" | . == "ccc" | . == "rua", NA, .))) %>%
rename(`Onde foi colhido?`= `Onde foi colhido`)
# faxinas201920$Valor <- formatC(faxinas201920$Valor, format = "f", digits = 2, decimal.mark = ",")
faxinas201920$Data <- format(faxinas201920$Data, "%d/%m/%Y")
faxinas201920[faxinas201920 == "TRUE"] <- "Sim"
faxinas201920[faxinas201920 == "FALSE"] <- "Não"
# mudar ocorreu pra sim e nao usando regex
faxinas201920$Cliente <- str_trim(str_to_title(faxinas201920$Cliente))
faxinas201920$Endereço <- str_trim(str_to_title(faxinas201920$Endereço))
faxinas201920$Comentários <- str_trim(faxinas201920$Comentários)
faxinas201920$Endereço <-  str_replace_all(faxinas201920$Endereço, "R\\.", "Rua ")
faxinas201920$Endereço <- str_replace_all(faxinas201920$Endereço, "R ", "Rua ")
faxinas201920$Endereço <- str_replace_all(faxinas201920$Endereço, "^Av.", "Avenida ")
faxinas201920$Endereço <- str_trim(str_to_title(faxinas201920$Endereço))
# depois customizar a tabela com os tamanhos certos "custom table container"
datatable(
faxinas201920,
colnames = c('ID' = 1),
caption =  htmltools::tags$caption(
style = 'caption-side: top; text-align: left; color:blue; font-size: 16px',
'Tabela 2: ',
htmltools::em('Gerenciamento do Aplicativo entre o período de 2019 a 2020.',)
),
class = c('cell-border stripe'),
extensions = c('Buttons'),
options = list(
dom = 'Bfrtip',
buttons = c('csv', 'excel', 'pdf', 'print', 'colvis')
)
)
faxinas201819$`Feedback cliente` <- as.double(faxinas201819$`Feedback cliente`)
faxinas201819 <- faxinas201819 %>%
rename(`Nota feedback cliente` = `Feedback cliente`, `Nota feedback mulher` = `Feedback mulher`)
# perguntar se junta feedback cliente da planilha nova com comentarios
# faxinas201920 <- faxinas201920 %>%
#   unite(`Comentários`, c(`Feedback cliente`,`Comentários`), na.rm = TRUE, remove = FALSE)
#
# faxinas201920$Comentários[faxinas201920$Comentários == '""'] <- "NA"
# faxinas201920[,"Comentários" == ""] <- "NA"
faxinas <- full_join(faxinas201819, faxinas201920,
by = c("Data", "Mulher", "Valor", "Cliente", "Endereço", "Ocorreu?", "Feedback Colhido?",
"Onde foi colhido?", "Nota feedback mulher", "Nota feedback cliente", "Comentários"))
faxinas <- faxinas %>% distinct() %>% group_by(Data)
faxinas
faxinas$`Nota feedback cliente`
faxinas$`Nota feedback cliente` == "3.0"
faxinas$`Nota feedback cliente` == "3.0
faxinas$`Nota feedback cliente` == 3.0
faxinas$`Nota feedback cliente` == 3
View(faxinas)
faxinas <- full_join(faxinas201819, faxinas201920,
by = c("Data", "Mulher", "Valor", "Cliente", "Endereço", "Ocorreu?", "Feedback Colhido?",
"Onde foi colhido?", "Nota feedback mulher", "Nota feedback cliente", "Comentários"))
faxinas <- faxinas %>% distinct() %>% group_by(Data)
View(faxinas)
shiny::runApp()
runApp()
runApp()
write_csv(faxinas, "/home/elizemiku/Documents/PURECO-BAS/Pureco/dados/faxinas.csv")
runApp()
shiny::runApp()
source('~/Documents/PURECO-BAS/Pureco/Tabs.R')
